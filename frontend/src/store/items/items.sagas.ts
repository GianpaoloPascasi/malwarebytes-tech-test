import { put, takeEvery } from "redux-saga/effects";
import { ITEMS_ACTIONS } from "./items.actions";
import { ItemsApi } from "../../api/items";
import { Item, itemsSliceActions } from "./items.slice";

function* getItems() {
  try {
    const items: Array<Item> = yield ItemsApi.fetchAll();
    yield put(itemsSliceActions.merge(items));
  } catch (e) {
    console.error(e);
  }
}

function* watchGetItems() {
  yield takeEvery(ITEMS_ACTIONS.FETCH_ALL, getItems);
}

const itemsSagas = [watchGetItems];
export default itemsSagas;
